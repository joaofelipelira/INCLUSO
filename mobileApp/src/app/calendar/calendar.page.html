<ion-content [fullscreen]="true">

  <div class="calendar-header-fixed">
    <div class="top-bar">
      <ion-button fill="clear" (click)="goBack()" color="light">
        <ion-icon name="chevron-back"></ion-icon>
      </ion-button>
      <h2>{{ currentMonth }}</h2>
      <ion-button fill="clear" color="light">
        <ion-icon name="ellipsis-vertical"></ion-icon>
      </ion-button>
    </div>

    <div class="days-strip">
      <div class="day-item" *ngFor="let d of days" [class.active]="d.active" (click)="selectDay(d)">
        <span class="day-name">{{ d.weekDay }}</span>
        <span class="day-number">{{ d.dayNumber }}</span>
        <div class="dot" *ngIf="d.hasEvent"></div>
      </div>
    </div>
  </div>

  <div class="timeline-container">
    
    <div class="no-events" *ngIf="filteredSchedule.length === 0">
      <p>Sem atividades para este dia.</p>
    </div>

    <div class="timeline-row" *ngFor="let item of filteredSchedule" [class.active-now]="item.status === 'now'">
      
      <div class="time-col">
        <span class="start-time">{{ item.time }}</span>
        <span class="end-time">{{ item.endTime }}</span>
      </div>

      <div class="now-indicator-line" *ngIf="item.status === 'now'">
        <div class="triangle"></div>
        <div class="line"></div>
      </div>

      <div class="card-col">
        <div class="event-card" [ngClass]="item.type">
          <div class="card-content">
            <h3>{{ item.title }}</h3>
            
            <div class="details">
              <span class="location">
                <ion-icon name="location-outline"></ion-icon> 
                {{ item.location }}
              </span>
              
              <span class="warning-badge" *ngIf="item.description">
                <ion-icon name="alert-circle"></ion-icon>
                PendÃªncia
              </span>
            </div>
          </div>
          
          <div class="status-label" *ngIf="item.status === 'now'">Agora</div>
        </div>
      </div>

    </div>

  </div>

  <ion-fab *ngIf="!isMenuOpen" vertical="bottom" horizontal="end" slot="fixed" class="custom-fab">
    <ion-fab-button (click)="toggleMenu()">
      <ion-icon name="menu-outline"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <div class="expanded-menu-bar" *ngIf="isMenuOpen">
    <div class="menu-icon" (click)="goBack()">
      <ion-icon name="person"></ion-icon>
    </div>
    <div class="menu-icon relative" (click)="goToChat()">
      <ion-icon name="chatbubbles"></ion-icon>
      <span class="menu-badge">3</span>
    </div>
    <div class="menu-icon active">
      <ion-icon name="calendar"></ion-icon>
    </div>
    <div class="menu-icon">
      <ion-icon name="help-circle"></ion-icon>
    </div>
    <div class="close-btn-container" (click)="toggleMenu()">
      <ion-icon name="chevron-back"></ion-icon>
    </div>
  </div>

</ion-content>